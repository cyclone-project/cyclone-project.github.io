/*! tinysort.js
 * version: 2.1.1
 * author: Ron Valstar (http://www.sjeiti.com/)
 * license: MIT/GPL
 * build: 2015-01-05
 */
!function (a, b) { "use strict"; function c() { return b } "function" == typeof define && define.amd ? define("tinysort", c) : a.tinysort = b }(this, function () { "use strict"; function a(a) { function f() { 0 === arguments.length ? j({}) : d(arguments, function (a) { j(c(a) ? { selector: a } : a) }), q = C.length } function j(a) { var b = !!a.selector, c = b && ":" === a.selector[0], d = e(a || {}, t); C.push(e({ bFind: b, bAttr: !(d.attr === i || "" === d.attr), bData: d.data !== i, bFilter: c, mFilter: i, fnSort: d.sortFunction, iAsc: "asc" === d.order ? 1 : -1 }, d)) } function m() { d(a, function (a, b) { x ? x !== a.parentNode && (D = !1) : x = a.parentNode; var c = C[0], d = c.bFilter, e = c.selector, f = !e || d && a.matchesSelector(e) || e && a.querySelector(e), g = f ? A : B, h = { elm: a, pos: b, posn: g.length }; z.push(h), g.push(h) }), w = A.slice(0) } function s() { A.sort(u) } function u(a, e) { var f = 0; for (0 !== r && (r = 0) ; 0 === f && q > r;) { var i = C[r], j = i.ignoreDashes ? o : n; if (d(p, function (a) { var b = a.prepare; b && b(i) }), i.sortFunction) f = i.sortFunction(a, e); else if ("rand" == i.order) f = Math.random() < .5 ? 1 : -1; else { var k = h, m = b(a, i), s = b(e, i); if (!i.forceStrings) { var t = c(m) ? m && m.match(j) : h, u = c(s) ? s && s.match(j) : h; if (t && u) { var v = m.substr(0, m.length - t[0].length), w = s.substr(0, s.length - u[0].length); v == w && (k = !h, m = l(t[0]), s = l(u[0])) } } f = m === g || s === g ? 0 : i.iAsc * (s > m ? -1 : m > s ? 1 : 0) } d(p, function (a) { var b = a.sort; b && (f = b(i, k, m, s, f)) }), 0 === f && r++ } return 0 === f && (f = a.pos > e.pos ? 1 : -1), f } function v() { var a = A.length === z.length; D && a ? (A.forEach(function (a) { y.appendChild(a.elm) }), x.appendChild(y)) : (A.forEach(function (a) { var b = a.elm, c = k.createElement("div"); a.ghost = c, b.parentNode.insertBefore(c, b) }), A.forEach(function (a, b) { var c = w[b].ghost; c.parentNode.insertBefore(a.elm, c), c.parentNode.removeChild(c) })) } c(a) && (a = k.querySelectorAll(a)), 0 === a.length && console.warn("No elements to sort"); var w, x, y = k.createDocumentFragment(), z = [], A = [], B = [], C = [], D = !0; return f.apply(i, Array.prototype.slice.call(arguments, 1)), m(), s(), v(), A.map(function (a) { return a.elm }) } function b(a, b) { var d, e = a.elm; return b.selector && (b.bFilter ? e.matchesSelector(b.selector) || (e = i) : e = e.querySelector(b.selector)), b.bAttr ? d = e.getAttribute(b.attr) : b.useVal ? d = e.value : b.bData ? d = e.getAttribute("data-" + b.data) : e && (d = e.textContent), c(d) && (b.cases || (d = d.toLowerCase()), d = d.replace(/\s+/g, " ")), d } function c(a) { return "string" == typeof a } function d(a, b) { for (var c, d = a.length, e = d; e--;) c = d - e - 1, b(a[c], c) } function e(a, b, c) { for (var d in b) (c || a[d] === g) && (a[d] = b[d]); return a } function f(a, b, c) { p.push({ prepare: a, sort: b, sortBy: c }) } var g, h = !1, i = null, j = window, k = j.document, l = parseFloat, m = Array.prototype.indexOf, n = /(-?\d+\.?\d*)$/g, o = /(\d+\.?\d*)$/g, p = [], q = 0, r = 0, s = "2.1.0", t = { selector: i, order: "asc", attr: i, data: i, useVal: h, place: "start", returns: h, cases: h, forceStrings: h, ignoreDashes: h, sortFunction: i }; return j.Element && function (a) { a.matchesSelector = a.matchesSelector || a.mozMatchesSelector || a.msMatchesSelector || a.oMatchesSelector || a.webkitMatchesSelector || function (a) { for (var b = this, c = (b.parentNode || b.document).querySelectorAll(a), d = -1; c[++d] && c[d] != b;); return !!c[d] } }(Element.prototype), e(f, { indexOf: m, loop: d }), e(a, { plugin: f, version: s, defaults: t }) }());!function(a){function t(a){var t=a.data("bootstrap-sortable-context");return null==t&&(t={bsSort:[],lastSort:null},a.data("bootstrap-sortable-context",t)),t}function r(a,t){tinysort(a,t)}function e(r,n){var d=parseFloat(r.attr("data-sortcolumn")),i=t(n),l=i.bsSort,c=r.attr("colspan");if(c){var f=Math.min(c-1,parseFloat(r.data("mainsort"))||0),p=parseFloat(r.data("sortkey").split("-").pop());if(n.find("thead tr").length-1>p)return void e(n.find('[data-sortkey="'+(d+f)+"-"+(p+1)+'"]'),n);d+=f}var h=r.attr("data-defaultsign")||s;if(n.find("th").each(function(){a(this).removeClass("up").removeClass("down").addClass("nosort")}),a.browser.mozilla){var v=n.find("div.mozilla");void 0!==v&&(v.find(".sign").remove(),v.parent().html(v.html())),r.wrapInner('<div class="mozilla"></div>'),r.children().eq(0).append('<span class="sign '+h+'"></span>')}else n.find("span.sign").remove(),r.append('<span class="sign '+h+'"></span>');var m=r.attr("data-sortkey"),u="desc"!==r.attr("data-firstsort")?"desc":"asc";i.lastSort=m,l[m]="asc"===(l[m]||u)?"desc":"asc","desc"===l[m]?(r.find("span.sign").addClass("up"),r.addClass("up").removeClass("down nosort")):r.addClass("down").removeClass("up nosort");var b=n.children("tbody").children("tr");o(b,{selector:"td:nth-child("+(d+1)+")",order:l[m],data:"value"}),n.find("td.sorted, th.sorted").removeClass("sorted"),b.find("td:eq("+d+")").addClass("sorted"),r.addClass("sorted")}var s,o,n=a(document);if(a.bootstrapSortable=function(n,d,i){var l="undefined"!=typeof moment;s=d?d:"arrow","default"==i&&(i=r),o=i||o||r,a("table.sortable").each(function(){var r=a(this),s=t(r),o=s.bsSort;n=n===!0,r.find("span.sign").remove(),r.find("thead [colspan]").each(function(){for(var t=parseFloat(a(this).attr("colspan")),r=1;t>r;r++)a(this).after('<th class="colspan-compensate">')}),r.find("thead [rowspan]").each(function(){for(var t=a(this),r=parseFloat(t.attr("rowspan")),e=1;r>e;e++){var s=t.parent("tr"),o=s.next("tr"),n=s.children().index(t);o.children().eq(n).before('<th class="rowspan-compensate">')}}),r.find("thead tr").each(function(t){a(this).find("th").each(function(r){var e=a(this);e.addClass("nosort").removeClass("up down"),e.attr("data-sortcolumn",r),e.attr("data-sortkey",r+"-"+t)})}),r.find("thead .rowspan-compensate, .colspan-compensate").remove(),r.find("td").each(function(){var t=a(this);void 0!==t.attr("data-dateformat")&&l?t.attr("data-value",moment(t.text(),t.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")):void 0===t.attr("data-value")&&t.attr("data-value",t.text())}),r.find('thead th[data-defaultsort!="disabled"]').each(function(){var t=a(this),r=t.closest("table.sortable");t.data("sortTable",r);var d=t.attr("data-sortkey"),i=n?s.lastSort:-1;o[d]=n?o[d]:t.attr("data-defaultsort"),void 0!==o[d]&&n===(d===i)&&(o[d]="asc"===o[d]?"desc":"asc",e(t,r))}),r.trigger("sorted")})},n.on("click",'table.sortable thead th[data-defaultsort!="disabled"]',function(){var t=a(this),r=t.data("sortTable")||t.closest("table.sortable");r.trigger("before-sort"),e(t,r),r.trigger("sorted")}),!a.browser){a.browser={chrome:!1,mozilla:!1,opera:!1,msie:!1,safari:!1};var d=navigator.userAgent;a.each(a.browser,function(t){a.browser[t]=new RegExp(t,"i").test(d)?!0:!1,a.browser.mozilla&&"mozilla"===t&&(a.browser.mozilla=new RegExp("firefox","i").test(d)?!0:!1),a.browser.chrome&&"safari"===t&&(a.browser.safari=!1)})}a(a.bootstrapSortable)}(jQuery);